<!DOCTYPE html>
<html>
<head>
  <title>Evaluating Biomarkers: Connecting the Theory to Practice</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />



  <meta name="date" content="2014-10-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" media="all" href="CDP-Science-Oct-2014_files/ioslides-13.5.1/fonts/fonts.css">

  <link rel="stylesheet" media="all" href="CDP-Science-Oct-2014_files/ioslides-13.5.1/theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="CDP-Science-Oct-2014_files/ioslides-13.5.1/theme/css/phone.css">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Evaluating Biomarkers: Connecting the Theory to Practice',
                        useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                favIcon: 'CDP-Science-Oct-2014_files/logo.svg',
              },

      // Author information
      presenters: [
            {
        name: 'Michael Sachs'
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }

    slides > slide:not(.nobackground):before {
      font-size: 12pt;
      content: "";
      position: absolute;
      bottom: 20px;
      left: 60px;
      background: url(CDP-Science-Oct-2014_files/logo.svg) no-repeat 0 50%;
      -webkit-background-size: 30px 30px;
      -moz-background-size: 30px 30px;
      -o-background-size: 30px 30px;
      background-size: 30px 30px;
      padding-left: 40px;
      height: 30px;
      line-height: 1.9;
    }
  </style>

  <link rel="stylesheet" href="styles.css" type="text/css" />


</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <aside class="gdbar"><img src="CDP-Science-Oct-2014_files/logo.svg"></aside>
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">October 30, 2014</p>
          </hgroup>
  </slide>

<slide class='segue dark nobackground'><hgroup class = 'auto-fadein'><h2>Introduction</h2></hgroup><article  id="introduction">

</article></slide><slide class=''><hgroup><h2>Evaluating Biomarkers: Practice</h2></hgroup><article  id="evaluating-biomarkers-practice">

<p><img src="CDP-Science-Oct-2014_files/figure-html/plot3.png" title="plot of chunk plot3" alt="plot of chunk plot3" width="480" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Evaluating Biomarkers: Practice</h2></hgroup><article  id="evaluating-biomarkers-practice-1">

<p><img src="CDP-Science-Oct-2014_files/figure-html/plot2.png" title="plot of chunk plot2" alt="plot of chunk plot2" width="576" style="display: block; margin: auto;" /> * p &lt; 0.001</p>

</article></slide><slide class=''><hgroup><h2>Evaluating Biomarkers: Practice</h2></hgroup><article  id="evaluating-biomarkers-practice-2">

<p><img src="CDP-Science-Oct-2014_files/figure-html/plot1.png" title="plot of chunk plot1" alt="plot of chunk plot1" width="768" style="display: block; margin: auto;" /> * p &lt; 0.001</p>

</article></slide><slide class=''><hgroup><h2>Evaluating Biomarkers: Theory</h2></hgroup><article  id="evaluating-biomarkers-theory">

<table class = 'rmdtable'>
<tr class="header">
<th align="left">Search Term</th>
<th align="left">Results</th>
</tr>
<tr class="odd">
<td align="left">Clinical Trial(s)</td>
<td align="left">926</td>
</tr>
<tr class="even">
<td align="left">Survival</td>
<td align="left">714</td>
</tr>
<tr class="odd">
<td align="left">Longitudinal</td>
<td align="left">634</td>
</tr>
<tr class="even">
<td align="left"><strong>(Bio)marker(s)</strong></td>
<td align="left"><strong>228</strong></td>
</tr>
<tr class="odd">
<td align="left">Gene/Genomic(s)</td>
<td align="left">180</td>
</tr>
</table>

<p>Search results from pubmed restricted to journals: <em>Statistics in Medicine, Biometrics, Biostatistics, Biometrical Journal</em></p>

</article></slide><slide class=''><hgroup><h2>About me and the BRB</h2></hgroup><article  id="about-me-and-the-brb">

<p>Responsibilities:</p>

<ul>
<li>Provide statistical leadership to programs in the CDP</li>
<li>Conduct research in Biostatistics

<ul>
<li>Not quite mathematics</li>
<li>Not quite epidemiology</li>
<li>Methods are intended to be used/understood by statisticians and non-statisticians</li>
</ul></li>
</ul>

<p><strong>Much of the published statistical research will never be used in practice.</strong></p>

</article></slide><slide class=''><hgroup><h2>Why?</h2></hgroup><article  id="why">

<ul>
<li>Lack of awareness</li>
<li>Lack of useful tools to implement the research</li>
</ul>

<p><strong>Greater impact through software and education</strong></p>

<p>Some of my efforts on this front can be found here:</p>

<p><a href='http://sachsmc.github.io' title=''>http://sachsmc.github.io</a></p>

</article></slide><slide class=''><hgroup><h2>Goals</h2></hgroup><article  id="goals">

<ul>
<li>Review statistical methods for evaluating biomarkers</li>
<li>Review practical needs of scientists evaluating biomarkers</li>
<li>Examine how the two intersect</li>
<li>Provide resources for using non-standard methods</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Uses of biomarkers/imaging tests in oncology</h2></hgroup><article  id="uses-of-biomarkersimaging-tests-in-oncology">

<ul>
<li>Screening (mammography, HPV test)</li>
<li>Diagnosis (HER-2, PSA)</li>
<li>Prognosis, predicting future recurrence (Oncotype, Mammaprint)</li>
<li>Treatment selection (ER, ALK, KRAS)</li>
</ul>

<p><a href='http://www.cancer.gov/cancertopics/factsheet/detection/tumor-markers' title=''>Source (cancer.gov)</a></p>

</article></slide><slide class='segue dark nobackground'><hgroup class = 'auto-fadein'><h2>The Basics</h2></hgroup><article  id="the-basics">

</article></slide><slide class=''><hgroup><h2>Biomarker statistics 101</h2></hgroup><article  id="biomarker-statistics-101">

<p>Binary biomarker and Binary outcome</p>

<style>
td { border: 1px #aaa solid;
     padding: .2em; 
     }
</style>

<table align="center" style="text-align:center; border:1px; background:transparent; font-size: medium;">

<tr>

<td colspan="2" style="border:none;">

</td>

<td colspan="2" style="background:#eeeebb;">

<b>Condition<br /> (as determined by &quot;Gold standard&quot;)</b>

</td>

</tr>

<tr>

<td style="border:none;">

</td>

<td style="background:#ddddcc;">

Total population

</td>

<td style="background:#ffffcc;">

Condition positive

</td>

<td style="background:#ddddaa;">

Condition negative

</td>

<td style="background:#ddddcc;">

Prevalence =<br /> Σ Condition positive

<div style="border-top:1px solid;">
Σ Total population</div>

</td>

</tr>

<tr>

<td rowspan="2" style="background:#bbeeee;">

<b>Test<br /> outcome</b>

</td>

<td style="background:#ccffff;">

Test<br /> outcome<br /> positive

</td>

<td style="background:#ccffcc;">

<span style="color:#006600;">
<b>True positive</b></span>

</td>

<td style="background:#eedddd;">

<span style="color:#cc0000;">
<b>False positive</b></span><br />

</td>

<td style="background:#ccffff;">

Positive predictive value (PPV) =<br /> Σ True positive

<div style="border-top:1px solid;">
Σ Test outcome positive</div>

</td>

</tr>

<tr>

<td style="background:#aadddd;">

Test<br /> outcome<br /> negative

</td>

<td style="background:#eedddd;">

<span style="color:#cc0000;">
<b>False negative</b></span><br />

</td>

<td style="background:#bbeebb;">

<span style="color:#006600;">
<b>True negative</b></span>

</td>

<td style="background:#aadddd;">

Negative predictive value (NPV) =<br /> Σ True negative

<div style="border-top:1px solid;">
Σ Test outcome negative</div>

</td>

</tr>

<tr>

<td style="border:none;">

</td>

<td style="border:none;">

</td>

<td style="background:#ffffcc;">

True positive fraction (TPF, Sensitivity) =<br /> Σ True positive

<div style="border-top:1px solid;">
Σ Condition positive</div>

</td>

<td style="background:#ddddaa;">

False positive fraction (FPF) =<br /> Σ False positive

<div style="border-top:1px solid;">
Σ Condition negative</div>

</td>

<td style="background:#ddddcc;">

Accuracy (ACC) =<br /> Σ True positive + Σ True negative

<div style="border-top:1px solid;">
Σ Total population</div>

</td>

</tr>

<tr>

<td style="border:none;">

</td>

<td style="border:none;">

</td>

<td style="background:#ffffcc;">

False negative fraction (FNF) =<br /> Σ False negative

<div style="border-top:1px solid;">
Σ Condition positive</div>

</td>

<td style="background:#ddddaa;">

True negative fraction</a> (TNF, Specificity) =<br /> Σ True negative

<div style="border-top:1px solid;">
Σ Condition negative</div>

</td>

</tr>

<tr>

<td style="border:none;">

</td>

</tr>

</table>

</article></slide><slide class=''><hgroup><h2>Probabilities and Proportions</h2></hgroup><article  id="probabilities-and-proportions">

<p><strong>Quality of test-based classifications:</strong></p>

<p>\[ TPF = Pr\{\mbox{Marker positive} | \mbox{Has condition} \} = Pr\{M = 1 | D = 1\} \]</p>

<p>\[ FPF = Pr\{M = 1 | D = 0 \} \]</p>

<p>Ideal: TPF = 1, FPF = 0; Bad: TPF = FPF</p>

<p><strong>Predictions</strong></p>

<p>\[ PPV = Pr\{D = 1 | M = 1\} \]</p>

<p>\[ NPV = Pr\{D = 0 | M = 0\} \]</p>

<p>Ideal: PPV = NPV = 1; Bad: PPV = \(Pr\{D = 1\}\); NPV = \(Pr\{D = 0\}\)</p>

</article></slide><slide class=''><hgroup><h2>Aside: terminology</h2></hgroup><article  id="aside-terminology">

<ul>
<li>Sensitivity = <emph class="blue">True</emph> <emph class="red">positive</emph> fraction</li>
<li>Specificity = 1 - <emph class="blue">False</emph> <emph class="red">positive</emph> fraction</li>
<li>\(Pr\{\color{red}{M = 1} | \color{blue}{D = 1}\}\)</li>
<li>\(Pr\{\color{red}{M = 1} | \color{blue}{D = 0}\}\)</li>
</ul>

<h3>You may also see FPR/TPR for false/true positive <strong>rate</strong>.</h3>

<h3>These are probabilities or proportions, not rates.</h3>

</article></slide><slide class=''><hgroup><h2>Examples</h2></hgroup><article  id="examples">

<blockquote>
<p>Approximately 50% of women screened annually for 10 years in the United States will experience abnormal mammogram but have no cancer</p>
</blockquote>

<blockquote>
<p>Mammograms miss about 20 percent of breast cancers that are present at the time of screening</p>
</blockquote>

<p><a href='http://www.cancer.gov/cancertopics/factsheet/detection/mammograms' title=''>Source (cancer.gov)</a></p>

<ul class = 'build'>
<li>What is the population under study (general)?</li>
<li>What does the test do?</li>
<li>What sub-population does the statistic apply to? (Test +, test -, healthy, diseased)</li>
</ul>

</article></slide><slide class=''><hgroup><h2>One statistic not enough</h2></hgroup><article  id="one-statistic-not-enough">

<p><strong>All of the information in that table can be obtained given only 3 of the quantities: </strong></p>

<ul>
<li>Usually, \((TPF, FPF, Pr\{D = 1\})\)</li>
<li>Occassionally, \((PPV, NPV, Pr\{M = 1\})\)</li>
</ul>

<p>Why? Bayes Rule:</p>

<p>\[ Pr\{M = 1 | D = 1\} = \frac{Pr\{M = 1 \mbox{ AND } D = 1\}}{Pr\{D = 1\}} = \frac{Pr\{D = 1 | M = 1\} Pr\{M = 1\}}{Pr\{D = 1\}} \]</p>

<ul>
<li>Most commonly, only a HR or OR is reported</li>
<li>HR/OR are insufficient to evaluate the accuracy of a test (<a href='http://aje.oxfordjournals.org/content/159/9/882.short' title=''>Pepe et al. 2004 AJE</a>)</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Extension 1</h2></hgroup><article  id="extension-1">

<p>What if the test yields a continuous measurement?</p>

<p><img src="CDP-Science-Oct-2014_files/figure-html/mamm.png" title="plot of chunk mamm" alt="plot of chunk mamm" width="768" /></p>

</article></slide><slide class=''><hgroup><h2>Solutions</h2></hgroup><article  id="solutions">

<h3>Goal is to assess accuracy using the aforementioned measures</h3>

<ul class = 'build'>
<li>Pick an arbitrary cutoff, say \(c\).</li>
<li>Now <em>test positive</em> is defined as \(M &gt; c\)</li>
<li>Consider measures as functions of \(c\), i.e. \[ TPF(c) = Pr\{M &gt; c | D = 1\} \] \[ FPF(c) = Pr\{M &gt; c | D = 0\} \]</li>
</ul>

</article></slide><slide class=''><hgroup><h2>ROC Curve</h2></hgroup><article  id="roc-curve">

<p><img src="CDP-Science-Oct-2014_files/figure-html/roctour.png" title="plot of chunk roctour" alt="plot of chunk roctour" width="480" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Comparing ROC Curves</h2></hgroup><article  id="comparing-roc-curves">

<p><img src="CDP-Science-Oct-2014_files/figure-html/roccomp.png" title="plot of chunk roccomp" alt="plot of chunk roccomp" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2></h2></hgroup><article  id="section">

<iframe src="https://sachsmc.shinyapps.io/illustrateROC/">

</iframe>

</article></slide><slide class=''><hgroup><h2>Make your own ROC Curves</h2></hgroup><article  id="make-your-own-roc-curves">

<p><a href='http://sachsmc.shinyapps.io/plotROC/' title=''>http://sachsmc.shinyapps.io/plotROC/</a></p>

<p>Send me your feedback.</p>

</article></slide><slide class=''><hgroup><h2>Extension 2</h2></hgroup><article  id="extension-2">

<ul>
<li>Binary outcome, good for diagnosis, screening</li>
<li>What about prognostic/predictive biomarkers?</li>
<li>Outcome of interest is <em>time to event</em>, i.e. PFS or OS</li>
<li>Instead of \(D = 1\) we have \(T &gt; t\)</li>
</ul>

<p><img src="CDP-Science-Oct-2014_files/figure-html/surv.png" title="plot of chunk surv" alt="plot of chunk surv" width="480" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Solutions</h2></hgroup><article  id="solutions-1">

<ul class = 'build'>
<li>Dichotomize time and proceed as binary

<ul>
<li>possibly throwing out data (censoring)</li>
</ul></li>
<li>Use the Kaplan-Meier estimate

<ul>
<li>Time-dependent TPF and FPF \[ TPF(c, t) = P(M &gt; c | T \leq t) \] \[ FPF(c, t) = P(M &gt; c | T &gt; t) \]</li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Time dependent TPF and FPF</h2></hgroup><article  id="time-dependent-tpf-and-fpf">

<p>A little algebra (Bayes rule again):</p>

<p>\[ TPF(c, t) = \frac{P(T \leq t | M &gt; c) P(M &gt; c)}{P(T \leq t)} \]</p>

<p>The KM curve is an estimate of \(P(T &gt; t)\), combine that with the proportion of \(M &gt; c\) and we are done.</p>

</article></slide><slide class=''><hgroup><h2>The plot</h2></hgroup><article  id="the-plot">

<p>Show curves for a small subset of event times:</p>

<p><img src="CDP-Science-Oct-2014_files/figure-html/survplot1.png" title="plot of chunk survplot" alt="plot of chunk survplot" width="480" /><img src="CDP-Science-Oct-2014_files/figure-html/survplot2.png" title="plot of chunk survplot" alt="plot of chunk survplot" width="480" /></p>

</article></slide><slide class=''><hgroup><h2>Prediction/Treatment Selection</h2></hgroup><article  id="predictiontreatment-selection">

<p>The Janes lab at the Fred Hutch has done lots of work in this area. <code>TreatmentSelection</code> R package, and others.</p>

<img src="CDP-Science-Oct-2014_files/figure-html/intpult1.png" title="plot of chunk intpult" alt="plot of chunk intpult" width="480" /><img src="CDP-Science-Oct-2014_files/figure-html/intpult2.png" title="plot of chunk intpult" alt="plot of chunk intpult" width="480" />

<p class="footnote">

Janes, Holly; Brown, Marshall D; Pepe, Margaret; Huang, Ying; &quot;An Approach to Evaluating and Comparing Biomarkers for Patient Treatment Selection&quot; 2014. The International Journal of Biostatistics.

</p>

</article></slide><slide class=''><hgroup><h2>Planning trials</h2></hgroup><article  id="planning-trials">

<p><a href='https://mdbrown.shinyapps.io/PowerSAM/' title=''>https://mdbrown.shinyapps.io/PowerSAM/</a></p>

</article></slide><slide class='segue dark nobackground'><hgroup class = 'auto-fadein'><h2>Conclusion</h2></hgroup><article  id="conclusion">

</article></slide><slide class=''><hgroup><h2>The tools are out there</h2></hgroup><article  id="the-tools-are-out-there">

<ul>
<li>Statistical methods and tools are available to address the tough clinical questions</li>
<li>Don&#39;t limit to what you can do or know how to do</li>
<li>Talk to your friendly, local statistician to find what you/your colleagues need</li>
<li>My job is to make these more understandable and accessible</li>
</ul>

<h4><a href='mailto:michael.sachs@nih.gov' title=''>michael.sachs@nih.gov</a></h4></article></slide>


  <slide class="backdrop"></slide>

</slides>

<script src="CDP-Science-Oct-2014_files/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
<script src="CDP-Science-Oct-2014_files/ioslides-13.5.1/js/prettify/prettify.js"></script>
<script src="CDP-Science-Oct-2014_files/ioslides-13.5.1/js/prettify/lang-r.js"></script>
<script src="CDP-Science-Oct-2014_files/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
<script src="CDP-Science-Oct-2014_files/ioslides-13.5.1/js/hammer.js"></script>
<script src="CDP-Science-Oct-2014_files/ioslides-13.5.1/js/slide-controller.js"></script>
<script src="CDP-Science-Oct-2014_files/ioslides-13.5.1/js/slide-deck.js"></script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
